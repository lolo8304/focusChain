import { Template } from 'meteor/templating';
import { ReactiveVar } from 'meteor/reactive-var';

import './main.html';

/**
 * if console writes "web3 is not defined", execute this command before starting meteor:
 * meteor add ethereum:web3$
 */
var carContract;
var contractInstance;

Template.hello.onCreated(function helloOnCreated() {
  // counter starts at 0
	this.counter = new ReactiveVar(0);
	
	if (typeof web3 !== 'undefined') {
		web3 = new Web3(web3.currentProvider);
	} else {
		// set the provider you want from Web3.providers
		web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8101"));
	}

	
	if(!web3.isConnected()) {
		console.log("NO - not connected");
	} else {
		console.log("YES - Connected to local geth");
		var contractAddress = localStorage.getItem("contract");
		if (contractAddress) {
			web3.eth.defaultAccount = web3.eth.accounts[0];
			carContract = web3.eth.contract([{"constant":false,"inputs":[],"name":"supply","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"model","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":false,"inputs":[],"name":"getState","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":false,"inputs":[{"name":"_insuranceId","type":"string"},{"name":"_policyNo","type":"string"}],"name":"matriculate","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"producer","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":true,"inputs":[],"name":"ccm","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":true,"inputs":[],"name":"details","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"insuranceId","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"chassisNo","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":false,"inputs":[],"name":"exmatriculate","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":false,"inputs":[{"name":"_owner","type":"address"}],"name":"sell","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"price","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":false,"inputs":[{"name":"_chassisNo","type":"string"},{"name":"_assemblyLine","type":"string"}],"name":"produce","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"state","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":true,"inputs":[],"name":"matriculated","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"policyNo","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"creationTime","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"constant":false,"inputs":[],"name":"dump","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"holder","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":false,"inputs":[],"name":"deliver","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"assemblyLine","outputs":[{"name":"","type":"string"}],"type":"function"},{"inputs":[{"name":"_model","type":"string"},{"name":"_ccm","type":"uint8"},{"name":"_price","type":"uint8"},{"name":"_details","type":"string"},{"name":"_producer","type":"address"},{"name":"_owner","type":"address"}],"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_producer","type":"address"},{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_modell","type":"string"},{"indexed":false,"name":"_ccm","type":"uint8"},{"indexed":false,"name":"_price","type":"uint8"}],"name":"Ordered","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_producer","type":"address"},{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"chassisNo","type":"string"}],"name":"Produced","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_garage","type":"address"}],"name":"Supplied","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"}],"name":"Delivered","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_insuranceId","type":"string"},{"indexed":false,"name":"_policyNo","type":"string"}],"name":"Matriculated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_policyNo","type":"string"}],"name":"Exmatriculated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_oldOwner","type":"address"},{"indexed":false,"name":"_newOwner","type":"address"}],"name":"Sold","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"}],"name":"Dumped","type":"event"}]);
			//carContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"_msg","type":"string"}],"name":"sendEvent","outputs":[],"type":"function"},{"inputs":[],"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_msg","type":"string"},{"indexed":false,"name":"_me","type":"address"}],"name":"Triggered","type":"event"}]);
			contractInstance = carContract.at(contractAddress);

			var event = contractInstance.allEvents().watch(function(error, result){
					console.log("EVENT FIRED");
					console.log(result);
			});				
		}
	}
});

Template.hello.helpers({
	
});

Template.hello.events({
	'click .btnDeploy'(event, instance) {
		deployContract(instance);
	},
	'click .btnProduce'(event, instance) {
		var contractInstance = carContract.at(localStorage.getItem("contract"));
		var result = contractInstance.produce("123", "BMW Munich");
	}
});

function deployContract(instance) {
	console.log("Deploying contract...");
	var _model = "Kia" ;
	var _ccm = 1 ;
	var _price = 10000 ;
	var _details = "nice car"  ;
	var _producer = "0x7690268bBf44665f223F69026207Be2BB8dD8764" ;
	var _owner = "0x7690268bBf44665f223F69026207Be2BB8dD8764" ;

	carContract = web3.eth.contract([{"constant":false,"inputs":[],"name":"supply","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"model","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":false,"inputs":[],"name":"getState","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":false,"inputs":[{"name":"_insuranceId","type":"string"},{"name":"_policyNo","type":"string"}],"name":"matriculate","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"producer","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":true,"inputs":[],"name":"ccm","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":true,"inputs":[],"name":"details","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"insuranceId","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"chassisNo","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":false,"inputs":[],"name":"exmatriculate","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":false,"inputs":[{"name":"_owner","type":"address"}],"name":"sell","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"price","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":false,"inputs":[{"name":"_chassisNo","type":"string"},{"name":"_assemblyLine","type":"string"}],"name":"produce","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"state","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":true,"inputs":[],"name":"matriculated","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"policyNo","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"creationTime","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"constant":false,"inputs":[],"name":"dump","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"holder","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":false,"inputs":[],"name":"deliver","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"assemblyLine","outputs":[{"name":"","type":"string"}],"type":"function"},{"inputs":[{"name":"_model","type":"string"},{"name":"_ccm","type":"uint8"},{"name":"_price","type":"uint8"},{"name":"_details","type":"string"},{"name":"_producer","type":"address"},{"name":"_owner","type":"address"}],"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_producer","type":"address"},{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_modell","type":"string"},{"indexed":false,"name":"_ccm","type":"uint8"},{"indexed":false,"name":"_price","type":"uint8"}],"name":"Ordered","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_producer","type":"address"},{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"chassisNo","type":"string"}],"name":"Produced","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_garage","type":"address"}],"name":"Supplied","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"}],"name":"Delivered","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_insuranceId","type":"string"},{"indexed":false,"name":"_policyNo","type":"string"}],"name":"Matriculated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"},{"indexed":false,"name":"_policyNo","type":"string"}],"name":"Exmatriculated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_oldOwner","type":"address"},{"indexed":false,"name":"_newOwner","type":"address"}],"name":"Sold","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_owner","type":"address"}],"name":"Dumped","type":"event"}]);
	//carContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"_msg","type":"string"}],"name":"sendEvent","outputs":[],"type":"function"},{"inputs":[],"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_msg","type":"string"},{"indexed":false,"name":"_me","type":"address"}],"name":"Triggered","type":"event"}]);
	var car = carContract.new(
		_model,
		_ccm,
		_price,
		_details,
		_producer,
		_owner, 
		{
			from: web3.eth.accounts[0],
			data: '60606040526000600060006101000a81548160ff02191690830217905550426001600050556000600c60006101000a81548160ff02191690830217905550604051611eb9380380611eb9833981016040528080518201919060200180519060200190919080519060200190919080518201919060200180519060200190919080519060200190919050505b8560056000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100d957805160ff191683800117855561010a565b8280016001018555821561010a579182015b828111156101095782518260005055916020019190600101906100eb565b5b5090506101359190610117565b808211156101315760008181506000905550600101610117565b5090565b505084600660016101000a81548160ff0219169083021790555083600660006101000a81548160ff021916908302179055508260076000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106101b657805160ff19168380011785556101e7565b828001600101855582156101e7579182015b828111156101e65782518260005055916020019190600101906101c8565b5b50905061021291906101f4565b8082111561020e57600081815060009055506001016101f4565b5090565b505081600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff0219169083021790555080600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff0219169083021790555033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055507feef352d7671e11c434ca17587dfe1aba2003d9a83f99df6741f07f6ee24aeaa8600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166005600050600660019054906101000a900460ff16600660009054906101000a900460ff16604051808673ffffffffffffffffffffffffffffffffffffffff1681526020018573ffffffffffffffffffffffffffffffffffffffff168152602001806020018460ff1681526020018360ff1681526020018281038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156103f45780601f106103c9576101008083540402835291602001916103f4565b820191906000526020600020905b8154815290600101906020018083116103d757829003601f168201915b5050965050505050505060405180910390a17f0717dc3ff38ee55357fb242e706e3116b990ee2e900e4dcdecffea8f3005cb52600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166005600050604051808473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff168152602001806020018281038252838181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156105335780601f1061050857610100808354040283529160200191610533565b820191906000526020600020905b81548152906001019060200180831161051657829003601f168201915b505094505050505060405180910390a15b505050505050611961806105586000396000f360606040523615610124576000357c010000000000000000000000000000000000000000000000000000000090048063047fc9aa146101315780630ad9d052146101405780631865c57d146101bb578063306d066f146101de578063376126721461027b5780633a16e5cf146102b4578063565974d3146102da5780635acf77b0146103555780636c56e453146103d05780636ec1c7ac1461044b5780638da5cb5b1461045a57806394b6f9d414610493578063a035b1fe146104ab578063a86af071146104d1578063c19d93fb1461056e578063cbfbc56214610591578063d7516d0d146105b6578063d8270dce14610631578063e433054514610654578063e534155d14610663578063fd3e50a71461069c578063fdca9988146106ab57610124565b61012f5b610002565b565b005b61013e6004805050610726565b005b61014d60048050506107d8565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156101ad5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101c86004805050610879565b6040518082815260200191505060405180910390f35b6102796004808035906020019082018035906020019191908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050909091908035906020019082018035906020019191908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050909091905050610895565b005b6102886004805050610bec565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6102c16004805050610c12565b604051808260ff16815260200191505060405180910390f35b6102e76004805050610c25565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156103475780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103626004805050610cc6565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156103c25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103dd6004805050610d67565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f16801561043d5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6104586004805050610e08565b005b610467600480505061103c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104a96004808035906020019091905050611062565b005b6104b86004805050611207565b604051808260ff16815260200191505060405180910390f35b61056c6004808035906020019082018035906020019191908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050909091908035906020019082018035906020019191908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505090909190505061121a565b005b61057b6004805050611518565b6040518082815260200191505060405180910390f35b61059e600480505061152b565b60405180821515815260200191505060405180910390f35b6105c3600480505061153e565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156106235780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61063e60048050506115df565b6040518082815260200191505060405180910390f35b61066160048050506115e8565b005b6106706004805050611723565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6106a96004805050611749565b005b6106b860048050506118c0565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156107185780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6001600060009054906101000a900460ff1614151561074457610002565b33600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055506002600060006101000a81548160ff021916908302179055507f6663c4b4f37934bad95a7e7828d7613470512e596e6278df939ba459ae7e0f6333604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b565b60056000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156108715780601f1061084657610100808354040283529160200191610871565b820191906000526020600020905b81548152906001019060200180831161085457829003601f168201915b505050505081565b6000600060009054906101000a900460ff169050610892565b90565b6002600060009054906101000a900460ff1610156108b257610002565b6004600060009054906101000a900460ff1614156108cf57610002565b600c60009054906101000a900460ff16156108e957610002565b81600a6000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061093857805160ff1916838001178555610969565b82800160010185558215610969579182015b8281111561096857825182600050559160200191906001019061094a565b5b5090506109949190610976565b808211156109905760008181506000905550600101610976565b5090565b505080600b6000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106109e557805160ff1916838001178555610a16565b82800160010185558215610a16579182015b82811115610a155782518260005055916020019190600101906109f7565b5b509050610a419190610a23565b80821115610a3d5760008181506000905550600101610a23565b5090565b50506001600c60006101000a81548160ff021916908302179055507fe96ca6abf0981325fc5774aa064813888413eb3a087e9b2d5483e567d7072c25600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600a600050600b600050604051808473ffffffffffffffffffffffffffffffffffffffff1681526020018060200180602001838103835285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610b535780601f10610b2857610100808354040283529160200191610b53565b820191906000526020600020905b815481529060010190602001808311610b3657829003601f168201915b5050838103825284818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610bd65780601f10610bab57610100808354040283529160200191610bd6565b820191906000526020600020905b815481529060010190602001808311610bb957829003601f168201915b50509550505050505060405180910390a15b5050565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600660019054906101000a900460ff1681565b60076000508054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cbe5780601f10610c9357610100808354040283529160200191610cbe565b820191906000526020600020905b815481529060010190602001808311610ca157829003601f168201915b505050505081565b600a6000508054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610d5f5780601f10610d3457610100808354040283529160200191610d5f565b820191906000526020600020905b815481529060010190602001808311610d4257829003601f168201915b505050505081565b60086000508054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610e005780601f10610dd557610100808354040283529160200191610e00565b820191906000526020600020905b815481529060010190602001808311610de357829003601f168201915b505050505081565b60006002600060009054906101000a900460ff161015610e2757610002565b6004600060009054906101000a900460ff161415610e4457610002565b600c60009054906101000a900460ff161515610e5f57610002565b600b60005090506020604051908101604052806000815260200150600b6000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610ec857805160ff1916838001178555610ef9565b82800160010185558215610ef9579182015b82811115610ef8578251826000505591602001919060010190610eda565b5b509050610f249190610f06565b80821115610f205760008181506000905550600101610f06565b5090565b50506000600c60006101000a81548160ff021916908302179055507f0cddcc8f5b2242316ef63f460256ebb28efd9136f54476bb257ffe702f404313600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1682604051808373ffffffffffffffffffffffffffffffffffffffff168152602001806020018281038252838181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156110295780601f10610ffe57610100808354040283529160200191611029565b820191906000526020600020905b81548152906001019060200180831161100c57829003601f168201915b5050935050505060405180910390a15b50565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60003373ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415156110c057610002565b6002600060009054906101000a900460ff1610156110dd57610002565b6004600060009054906101000a900460ff1614156110fa57610002565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff0219169083021790555081600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055507fa368df6d8ea29fc7367045e5c6a2e3a04b89059842ed575d55ce8531117cfeae81600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808373ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a15b5050565b600660009054906101000a900460ff1681565b6000600060009054906101000a900460ff1614151561123857610002565b8160086000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061128757805160ff19168380011785556112b8565b828001600101855582156112b8579182015b828111156112b7578251826000505591602001919060010190611299565b5b5090506112e391906112c5565b808211156112df57600081815060009055506001016112c5565b5090565b50508060096000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061133457805160ff1916838001178555611365565b82800160010185558215611365579182015b82811115611364578251826000505591602001919060010190611346565b5b5090506113909190611372565b8082111561138c5760008181506000905550600101611372565b5090565b505033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055506001600060006101000a81548160ff021916908302179055507f0717dc3ff38ee55357fb242e706e3116b990ee2e900e4dcdecffea8f3005cb52600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166008600050604051808473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff168152602001806020018281038252838181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156115035780601f106114d857610100808354040283529160200191611503565b820191906000526020600020905b8154815290600101906020018083116114e657829003601f168201915b505094505050505060405180910390a15b5050565b600060009054906101000a900460ff1681565b600c60009054906101000a900460ff1681565b600b6000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156115d75780601f106115ac576101008083540402835291602001916115d7565b820191906000526020600020905b8154815290600101906020018083116115ba57829003601f168201915b505050505081565b60016000505481565b3373ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614151561164457610002565b6002600060009054906101000a900460ff16101561166157610002565b6004600060009054906101000a900460ff16141561167e57610002565b600c60009054906101000a900460ff161561169857610002565b6004600060006101000a81548160ff021916908302179055507fb6cbd8f05cc993a7f9f31320e1002d98126f4eafbe9231e24b0b340de511d06f600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b565b600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b3373ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415156117a557610002565b6002600060009054906101000a900460ff1610156117c257610002565b6004600060009054906101000a900460ff1614156117df57610002565b6003600060006101000a81548160ff0219169083021790555033600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff0219169083021790555033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055507ffedf826d9b4a1fe2a221dc900337fc72788ddb41c7ae6600c110ca2858365da4600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b565b60096000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156119595780601f1061192e57610100808354040283529160200191611959565b820191906000526020600020905b81548152906001019060200180831161193c57829003601f168201915b50505050508156', 
			gas: 3000000
		}, function(e, contract){
			console.log(e, contract);
			if (typeof contract.address != 'undefined') {
				console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
				localStorage.setItem("contract", contract.address);
				contractInstance = carContract.at(contract.address);

			}
		})
		/*var car = carContract.new(
		   {
			 from: web3.eth.accounts[0], 
			 data: '60606040525b5b610151806100146000396000f36060604052361561003d576000357c01000000000000000000000000000000000000000000000000000000009004806327e0b8991461004a5761003d565b6100485b610002565b565b005b61009e6004808035906020019082018035906020019191908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509090919050506100a0565b005b7fca4320bad69991769fd2ab62398d8453e2cf846a781c74ae7de26f4d059188d0813360405180806020018373ffffffffffffffffffffffffffffffffffffffff1681526020018281038252848181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f16801561013f5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a15b5056', 
			 gas: 3000000
		   }, function(e, contract){
			console.log(e, contract);
			if (typeof contract.address != 'undefined') {
				 console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
				 localStorage.setItem("contract", contract.address);
			}
		 })*/
	}
